<app-loading *ngIf="spinnerService.visibility | async"></app-loading>
<mat-grid-list rowHeight="1.5em" cols="1">
    <mat-grid-tile>
        <div class="right-elem">
            <button mat-icon-button (click)="closeDialog()"><img [src]="closeGrigio" alt="closeGrigio"></button>
        </div>
    </mat-grid-tile>
</mat-grid-list>
<app-title [title]="'Cerca impresa'" [subtitle]="''"></app-title>
<div style="width: 83%; margin: auto;">
    <app-message-box [titolo]="titoloMessaggio" [descrizione]="descrzioneMessaggio" [type]="tipomessaggio"
        *ngIf="showMessaggio && titoloMessaggio && tipomessaggio">
    </app-message-box>
</div>
<div>
    <mat-card>
        <mat-card-content>
            <form class="form-container" [formGroup]="searchForm">
                <mat-grid-list cols="2" rowHeight="2em">
                    <mat-grid-tile colspan="2" rowspan="2">
                        <mat-form-field class="form-field">
                            <input matInput placeholder="Codice fiscale" [formControlName]="'cf'" appUpper>
                        </mat-form-field>
                    </mat-grid-tile>
                    <mat-grid-tile rowspan="2" colspan="2">
                        <button mat-button class="secondary-button" (click)="cercaPerCF()"
                            [disabled]="searchForm.controls.cf.errors && searchForm.controls.cf.errors.pattern">
                            CERCA PER CODICE FISCALE</button>
                    </mat-grid-tile>
                    <mat-grid-tile rowspan="2" colspan="2">
                        <hr class="hr-left">
                        <h5>oppure</h5>
                        <hr class="hr-right">
                    </mat-grid-tile>
                    <mat-grid-tile rowspan="2" colspan="2">
                        <mat-form-field class="form-field">
                            <input matInput placeholder="Sigla REA" [formControlName]="'siglaRea'" appUpper>
                        </mat-form-field>
                    </mat-grid-tile>
                    <mat-grid-tile rowspan="2" colspan="2">
                        <mat-form-field class="form-field">
                            <input matInput placeholder="Numero REA" [formControlName]="'numeroRea'">
                        </mat-form-field>
                    </mat-grid-tile>
                    <mat-grid-tile rowspan="2" colspan="2">
                        <button mat-button class="secondary-button" (click)="cercaPerREA()" [disabled]="(searchForm.controls.numeroRea.errors && searchForm.controls.numeroRea.errors.pattern)
                        ||(searchForm.controls.siglaRea.errors && searchForm.controls.siglaRea.errors.pattern)">
                            CERCA PER CODICE REA</button>
                    </mat-grid-tile>
                </mat-grid-list>
            </form>
        </mat-card-content>
    </mat-card>

    <app-title [title]="'Imprese'" *ngIf="imprese.length>0"></app-title>
    <mat-card class="card" *ngFor="let impresa of imprese">
        <mat-card-content>
            <mat-grid-list cols="1" rowHeight="1em">
                <mat-grid-tile>
                    <div class="left-elem">Codice fiscale:</div>
                </mat-grid-tile>
                <mat-grid-tile>
                    <div class="left-elem def-elem">{{impresa.codice_fiscale}}</div>
                </mat-grid-tile>
                <mat-grid-tile></mat-grid-tile>
                <mat-grid-tile>
                    <div class="left-elem">Cognome/Denominazione:</div>
                </mat-grid-tile>
                <mat-grid-tile  [rowspan]="calcRowSpan(impresa.denominazione)">
                    <div class="left-elem def-elem">{{impresa.denominazione}}</div>
                </mat-grid-tile>
                <mat-grid-tile></mat-grid-tile>
                <!-- <mat-grid-tile>
                    <div class="left-elem">Nome:</div>
                </mat-grid-tile>
                <mat-grid-tile>
                    <div class="left-elem def-elem">{{persona.nome}}</div>
                </mat-grid-tile> -->
                <mat-grid-tile></mat-grid-tile>
                <mat-grid-tile>
                    <div class="left-elem">Indirizzo:</div>
                </mat-grid-tile>
                <mat-grid-tile rowspan="2">
                    <div class="left-elem def-elem" *ngIf="impresa.indirizzo_sitad">{{impresa.indirizzo_sitad}}
                        {{impresa.civico}}, {{impresa.comune}} - {{impresa.provincia}}</div>
                    <div class="left-elem def-elem" *ngIf="impresa.indirizzo_non_trovato">
                        {{impresa.indirizzo_non_trovato}}
                        {{impresa.civico}}, {{impresa.comune}} - {{impresa.provincia}}</div>
                    <div class="left-elem def-elem" *ngIf="!impresa.indirizzo_sitad && !impresa.indirizzo_non_trovato">
                        {{impresa.stato_estero}}, {{impresa.indirizzo_estero}} {{impresa.citta_estero}} -
                        {{impresa.cap_estero}}</div>
                </mat-grid-tile>
                <mat-grid-tile></mat-grid-tile>
                <mat-grid-tile rowspan="2">
                    <button mat-button class="default-button" (click)="goToGestioneDati(impresa)">USA DATI</button>
                </mat-grid-tile>
            </mat-grid-list>
        </mat-card-content>
    </mat-card>
    <mat-card class="card" *ngIf="imprese.length==0 && searched">
        <app-message-box [titolo]="'Nessun elemento trovato'"
            [descrizione]="'Nessuna persona giuridica trovata con i parametri indicati'" [type]="1">
        </app-message-box>
    </mat-card>
</div>
<!-- </div> -->
<!-- </div> -->